
# DENIED

* **Category**: Network Operations
* **Points**: 1200
* **Challenge**: We've received intelligence that indicates the group known as 'hacking.haus' is performing malicious actions on behalf of our adversary. You have been authorized to recon and engage them with any and all means available. Our sources indicate that they have a publicly facing web and mail server. Additionally, one of their members checks his email regularly as he is expecting a pdf from a fellow hacker. Our source says that due to internal policy, they are using Adobe Reader XI 11.0.01. Your goal is to gain Administrator access to their Domain Controller, capturing flags along the way. All boxes have one flag unless the flag file states otherwise. Good luck! NOTE: The IP given on this page is the IP of a Kali jump box to be used for this operation. Feel free to only use it to tunnel through, or use it directly (ssh creds: root:toor CHANGE ASAP!). It has lots of tools in /opt, some may be helpful! 


#dont forget to move to the jjumo bix first 

ssh root@

# What is the IP address of the target

nslookup hacking.haus

Server:		192.0.2.1
Address:	192.0.2.1#53

Name:	hacking.haus
Address: 198.51.100.29


nmap 198.51.100.29

Starting Nmap 7.70 ( https://nmap.org ) at 2020-06-09 11:07 EDT
Stats: 0:00:14 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 0.80% done
Nmap scan report for 198.51.100.29
Host is up, received reset ttl 62 (0.00047s latency).
Not shown: 999 filtered ports
Reason: 997 no-responses and 2 net-unreaches
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack ttl 62


nmap -sC -sV -Pn -p- 198.51.100.29

Starting Nmap 7.70 ( https://nmap.org ) at 2020-06-09 11:08 EDT
Stats: 0:01:11 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 45.76% done; ETC: 11:11 (0:01:09 remaining)
Nmap scan report for 198.51.100.29
Host is up, received user-set (0.00032s latency).
Not shown: 65534 filtered ports
Reason: 65532 no-responses and 2 net-unreaches
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE REASON         VERSION
80/tcp open  http    syn-ack ttl 62 Apache httpd 2.4.7 ((Ubuntu))
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Did not follow redirect to http://www.hacking.haus/

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 124.56 seconds


# Ok time to go after port 80

gobuster -w /usr/share/wordlists/dirb/common.txt -t 30 -x html,asp,php -u http://198.51.100.29 -o gobuster

# did not work?

nikto -h http://198.51.100.29

- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          198.51.100.29
+ Target Hostname:    198.51.100.29
+ Target Port:        80
+ Start Time:         2020-06-09 11:23:29 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.7 (Ubuntu)
+ Retrieved x-powered-by header: PHP/5.5.9-1ubuntu4.25
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Root page / redirects to: http://www.hacking.haus/
+ Uncommon header 'link' found, with contents: <http://www.hacking.haus/>; rel=shortlink
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80 
+ OSVDB-3233: /icons/README: Apache default file found.
+ /wp-links-opml.php: This WordPress script reveals the installed version.
+ OSVDB-3092: /license.txt: License file found may identify site software.
+ Cookie wordpress_test_cookie created without the httponly flag
+ OSVDB-3268: /wp-content/uploads/: Directory indexing found.
+ /wp-content/uploads/: Wordpress uploads directory is browsable. This may reveal sensitive information
+ /wp-login.php: Wordpress login found
+ 7535 requests: 0 error(s) and 16 item(s) reported on remote host
+ End Time:           2020-06-09 11:23:44 (GMT-4) (15 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested


# that worked, looks like a word press server, lets get the version...

curl http://198.51.100.29/wp-links-opml.php


<?xml version="1.0"?>
<opml version="1.0">
	<head>
		<title>Links for Hacking.Haus</title>
		<dateCreated>Tue, 09 Jun 2020 15:33:18 GMT</dateCreated>
		<!-- generator="WordPress/4.9.7" -->
	</head>
	<body>

# Wordpress 4.9.7, any exploits, lets also try wpscan for anythin else.



# check the login page:

curl http://198.51.100.29/wp-login.php

# set up ssh tunneling to port 80 on the target maching 

ssh -L 8080:198.51.100.29:80 172.30.78.222root@ -NT

# worked, now let enumerate more 

gobuster -w /usr/share/wordlists/dirb/common.txt -t 30 -x html,asp,php -u http://localhost:8080 -o gobuster


=====================================================
2020/06/09 09:54:34 Starting gobuster
=====================================================
/.htpasswd (Status: 403)
/.htpasswd.html (Status: 403)
/.htpasswd.asp (Status: 403)
/.htpasswd.php (Status: 403)
/.htaccess (Status: 403)
/.htaccess.html (Status: 403)
/.htaccess.asp (Status: 403)
/.htaccess.php (Status: 403)
/.hta (Status: 403)
/.hta.html (Status: 403)
/.hta.asp (Status: 403)
/.hta.php (Status: 403)
/index.php (Status: 200)
/index.php (Status: 200)
/readme.html (Status: 200)
/server-status (Status: 403)
/wp-admin (Status: 301)
/wp-blog-header.php (Status: 200)
/wp-config.php (Status: 200)
/wp-cron.php (Status: 200)
/wp-load.php (Status: 200)
/wp-includes (Status: 301)
/wp-content (Status: 301)
/wp-login.php (Status: 200)
/wp-mail.php (Status: 403)
/wp-links-opml.php (Status: 200)
/wp-signup.php (Status: 302)
/wp-trackback.php (Status: 200)
=====================================================
2020/06/09 09:55:38 Finished
=====================================================



# lost of wordpress.., lets wpscan 

http://localhost:8080/wp-includes/
# has lots of files 

/wp-login.php
# login page, long load time

wp-trackback.php
<message>I really need an ID for this to work.</message>
#maybe a parameter????

# lets wpscan...
# not working...
